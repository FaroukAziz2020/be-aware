# BE AWARE ‚Äì Food Allergen & Nutrition Extractor

**Stay safe with every bite.**  
Upload any food product **PDF** (text-based or scanned) to instantly detect **10 allergens** and extract **6 key nutritional values** using **OCR + AI**.

---

## üåê Live Demo

**Frontend:** [https://be-aware.vercel.app](https://be-aware.vercel.app)  
**Backend API:** [https://be-aware-backend.onrender.com](https://be-aware-backend.onrender.com)  
*(Replace with your actual deployed URLs after deployment)*

---

## ‚ú® Features

| Feature | Description |
|---------|-------------|
| **PDF Upload** | Drag & drop or select any food label PDF |
| **OCR for Scanned PDFs** | Uses **Tesseract OCR** (multi-language support: 17+ languages) |
| **AI-Powered Extraction** | **DeepSeek LLM** via OpenRouter parses unstructured text |
| **Allergen Detection** | 10 EU-regulated allergens: `Gluten`, `Egg`, `Crustaceans`, `Fish`, `Peanut`, `Soy`, `Milk`, `Tree Nuts`, `Celery`, `Mustard` |
| **Nutrition Facts** | 6 key values: `Energy`, `Fat`, `Carbohydrate`, `Sugar`, `Protein`, `Sodium` |
| **Multi-Language UI** | **English ¬∑ Fran√ßais ¬∑ Deutsch ¬∑ Magyar** |
| **Dark Mode** | Toggle between light/dark themes with persistent preference |
| **PDF Report Download** | Generate & download a formatted **awareness report** in selected language |
| **Responsive Design** | Mobile, tablet, desktop ready |
| **Progress Feedback** | Real-time upload + analysis progress bar |
| **Error Handling** | User-friendly toasts for all states |
| **Developer Dashboard** | Built-in `/developer` endpoint to test all services |

---

## üõ†Ô∏è Tech Stack

### Frontend
- **React 18** + **Vite**
- **i18next** ‚Äì Internationalization (4 languages)
- **react-toastify** ‚Äì Toast notifications
- **Lucide Icons** ‚Äì Modern icon system
- **CSS Custom Properties** ‚Äì Dynamic theming system
- **XMLHttpRequest + Progress Events** ‚Äì Upload tracking with real-time feedback

### Backend
- **FastAPI** ‚Äì Modern Python web framework
- **PyPDF2** ‚Äì Extract text from digital PDFs
- **pdf2image + Pytesseract** ‚Äì OCR for image-based/scanned PDFs
- **OpenRouter + DeepSeek** ‚Äì LLM for structured JSON extraction
- **ReportLab** ‚Äì Generate downloadable PDF reports with localization
- **uvicorn** ‚Äì ASGI server
- **python-dotenv** ‚Äì Environment configuration

---

## üöÄ Setup & Running Locally

### Prerequisites

- **Python 3.9+**
- **Node.js 18+**
- **Tesseract OCR** installed:
  - **Windows**: [Download installer](https://github.com/UB-Mannheim/tesseract/wiki)
  - **macOS**: `brew install tesseract`
  - **Linux**: `sudo apt install tesseract-ocr tesseract-ocr-eng tesseract-ocr-deu tesseract-ocr-fra`

---

### 1. Backend Setup

```bash
cd backend

# Create virtual environment
python -m venv venv

# Activate virtual environment
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt
```

**Create `.env` file in `backend/`:**

```env
# Required: OpenRouter API Key
OPENROUTER_API_KEY=your_openrouter_api_key_here

# Optional: Tesseract path (Windows only, if not in default location)
TESSERACT_CMD=C:\Program Files\Tesseract-OCR\tesseract.exe

# Optional: OCR languages (defaults shown below)
OCR_LANGUAGES=eng+deu+fra+spa+ita+por+hun+pol+ces+slk+ron+bul+hrv+slv+est+lav+lit

# Optional: Upload limits
MAX_UPLOAD_SIZE_BYTES=15728640  # 15MB default
```

**Get your OpenRouter API key:**
1. Visit [https://openrouter.ai](https://openrouter.ai)
2. Sign up/login
3. Go to **Keys** section
4. Create new key
5. Copy to `.env` file

**Start server:**

```bash
python app.py
# or
uvicorn app:app --reload --port 8000
```

**Backend URLs:**
- API: `http://127.0.0.1:8000`
- Documentation: `http://127.0.0.1:8000/docs`
- Developer Dashboard: `http://127.0.0.1:8000/developer` ‚≠ê

---

### 2. Frontend Setup

```bash
cd frontend

# Install dependencies
npm install
```

**Create `.env` in `frontend/`:**

```env
VITE_API_URL=http://127.0.0.1:8000/upload
```

**Start dev server:**

```bash
npm run dev
```

**Frontend URL:** `http://localhost:5173`

---

## üß™ Testing the Application

### 1. Test Backend Services
Visit the developer dashboard: `http://127.0.0.1:8000/developer`

This interactive dashboard shows:
- ‚úÖ LLM service status
- ‚úÖ OCR/Tesseract status
- ‚úÖ Available OCR languages
- ‚úÖ Configuration details
- ‚úÖ Quick test buttons

### 2. Test API Endpoints
Visit the auto-generated API documentation: `http://127.0.0.1:8000/docs`

Try these endpoints:
- `GET /health` - Check all services
- `GET /supported-languages` - View OCR languages
- `POST /upload` - Upload a PDF for analysis
- `POST /generate-pdf` - Generate a report

### 3. Test Frontend
1. Open `http://localhost:5173`
2. Try uploading a food label PDF
3. Test language switching (EN/FR/DE/HU)
4. Toggle dark mode
5. Download PDF report

---

## üì¶ Backend Dependencies

**Python Packages** (`requirements.txt`):
```txt
fastapi==0.104.1
uvicorn==0.24.0
python-dotenv==1.0.0
openai==1.3.5
pytesseract==0.3.10
pdf2image==1.16.3
PyPDF2==3.0.1
reportlab==4.0.7
python-multipart==0.0.6
```

**System Dependencies:**
- **Tesseract OCR** - For text extraction from images
- **Poppler** - For PDF to image conversion
  - **Windows**: [Download here](https://github.com/oschwartz10612/poppler-windows/releases) and add to PATH
  - **macOS**: `brew install poppler`
  - **Linux**: `sudo apt install poppler-utils`

---

## üåç Deployment Guide

### Frontend ‚Üí Vercel (Free)

1. **Push code to GitHub**
2. Go to [vercel.com](https://vercel.com) ‚Üí **Import Project**
3. Select your repository
4. **Configure:**
   - **Root Directory:** `frontend`
   - **Framework Preset:** Vite (auto-detected)
   - **Build Command:** `npm run build`
   - **Output Directory:** `dist`
5. **Add environment variable:**
   ```
   Name: VITE_API_URL
   Value: https://your-backend.onrender.com/upload
   ```
   *(Add this after backend is deployed)*
6. Click **Deploy**

---

### Backend ‚Üí Render (Free Tier)

1. Go to [render.com](https://render.com) ‚Üí **New Web Service**
2. Connect your GitHub repository
3. **Configure:**
   ```
   Name: be-aware-backend
   Region: Frankfurt (or closest to you)
   Branch: main
   Root Directory: backend
   Runtime: Python 3
   Build Command: pip install -r requirements.txt
   Start Command: uvicorn app:app --host 0.0.0.0 --port $PORT
   Instance Type: Free
   ```

4. **Add environment variables:**
   ```
   OPENROUTER_API_KEY=your_actual_key_here
   OCR_LANGUAGES=eng+deu+fra+hun
   ```

5. **Create `Aptfile` in `backend/` directory:**
   ```
   tesseract-ocr
   tesseract-ocr-eng
   tesseract-ocr-deu
   tesseract-ocr-fra
   tesseract-ocr-hun
   tesseract-ocr-spa
   tesseract-ocr-ita
   poppler-utils
   ```

6. Click **Create Web Service**
7. Wait 5-10 minutes for first deployment

**‚ö†Ô∏è Note:** Free tier has cold starts (~50 seconds). First request may be slow.

---

### Update Frontend with Backend URL

After backend is deployed on Render:

1. Copy your Render backend URL: `https://your-app.onrender.com`
2. Go to Vercel Dashboard ‚Üí Your Project ‚Üí **Settings** ‚Üí **Environment Variables**
3. Edit `VITE_API_URL`:
   ```
   VITE_API_URL=https://your-app.onrender.com/upload
   ```
4. **Redeploy** (Vercel will auto-redeploy)

---

## üìã API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/` | API information |
| `GET` | `/health` | Health check (all services) |
| `GET` | `/developer` | Interactive developer dashboard |
| `GET` | `/supported-languages` | List OCR languages |
| `POST` | `/upload` | Analyze PDF (multipart/form-data) |
| `POST` | `/generate-pdf` | Generate report PDF (application/json) |

### Example: Upload PDF

```bash
curl -X POST "http://127.0.0.1:8000/upload" \
  -F "file=@product_label.pdf" \
  -F "language=en"
```

**Response:**
```json
{
  "success": true,
  "filename": "product_label.pdf",
  "file_size_bytes": 245680,
  "processing_time_seconds": 3.42,
  "data": {
    "allergens": {
      "gluten": true,
      "milk": true,
      "egg": false,
      "soy": true,
      "peanut": false,
      "crustaceans": false,
      "fish": false,
      "tree_nuts": false,
      "celery": false,
      "mustard": false
    },
    "nutritional_values": {
      "energy": "2000 kJ / 478 kcal",
      "fat": "25g",
      "carbohydrate": "50g",
      "sugar": "8g",
      "protein": "7g",
      "sodium": "1.2g"
    },
    "metadata": {
      "ocr_used": false,
      "language_selected": "en",
      "confidence": "high"
    }
  }
}
```

---

## üêõ Troubleshooting

### Backend Issues

**LLM Not Working?**
- ‚úÖ Check `.env` has `OPENROUTER_API_KEY`
- ‚úÖ Verify key at [openrouter.ai](https://openrouter.ai)
- ‚úÖ Check `/developer` dashboard for status
- ‚úÖ Look at terminal logs for errors

**OCR Not Working?**
- ‚úÖ Install Tesseract OCR
- ‚úÖ Windows: Set `TESSERACT_CMD` in `.env`
- ‚úÖ Check `/developer` dashboard for Tesseract status
- ‚úÖ Test: `tesseract --version` in terminal

**Poppler Error (pdf2image)?**
- ‚úÖ Install Poppler (see dependencies section)
- ‚úÖ Windows: Add Poppler `bin/` folder to PATH
- ‚úÖ Restart terminal after installation

### Frontend Issues

**API Connection Failed?**
- ‚úÖ Check backend is running on `http://127.0.0.1:8000`
- ‚úÖ Verify `VITE_API_URL` in frontend `.env`
- ‚úÖ Check CORS settings in `config.py`
- ‚úÖ Open browser console (F12) for errors

**Dark Mode Not Persisting?**
- ‚úÖ Check browser allows localStorage
- ‚úÖ Clear browser cache and reload
- ‚úÖ Try in incognito/private mode

**Build Errors?**
- ‚úÖ Delete `node_modules/` and `package-lock.json`
- ‚úÖ Run `npm install` again
- ‚úÖ Check Node.js version: `node --version` (should be 18+)

---

## üéØ Project Structure

```
Developer_Test/
‚îÇ
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ .env                      # Environment variables
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore               
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt          # Python dependencies
‚îÇ   ‚îú‚îÄ‚îÄ Aptfile                   # System packages for Render
‚îÇ   ‚îú‚îÄ‚îÄ app.py                    # FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # Configuration management
‚îÇ   ‚îú‚îÄ‚îÄ llm.py                    # LLM client
‚îÇ   ‚îú‚îÄ‚îÄ pdf_analyzer.py           # PDF analysis logic
‚îÇ   ‚îú‚îÄ‚îÄ TextExtraction.py         # OCR service
‚îÇ   ‚îî‚îÄ‚îÄ pdf_generator.py          # Report generation
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ .env                      # API URL
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.jsx              # React entry point
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.jsx               # Main app component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.css               # Global styles
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ i18n.js               # Internationalization
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/           # React components
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ FileUploader.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProgressBar.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AllergensDisplay.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ NutritionDisplay.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ResultsSection.jsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ LanguageSelector.jsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ThemeToggle.jsx
‚îÇ   ‚îú‚îÄ‚îÄ index.html                # HTML template
‚îÇ   ‚îú‚îÄ‚îÄ package.json              # Node dependencies
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.js            # Vite configuration
‚îÇ
‚îú‚îÄ‚îÄ .gitignore                    # Git ignore file
‚îî‚îÄ‚îÄ README.md                     # This file
```


## üë§ Author

**Farouk Aziz** (BQ2AQM)  
üìß farouk.aziz@mailbox.unideb.hu